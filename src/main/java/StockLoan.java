import com.google.gson.stream.JsonReader;
import db.DbTool;

import java.io.IOException;
import java.io.StringReader;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.util.ArrayList;

public class StockLoan {
    private static final int INDEX_ID = 0;
    private static final int INDEX_NAME = 1;
    private static final int INDEX_DATEFROM = 2;
    private static final int INDEX_DATEEND = 3;
    private static final int INDEX_REASON = 4;
    private static final String result = "{\"data\":[[\"00714\",\"群益道瓊美國地產\",\"108.04.11\",\"108.04.16\",\"分配收益\"],[\"1102\",\"亞泥\",\"108.04.18\",\"108.04.23\",\"股東常會\"],[\"1103\",\"嘉泥\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"1104\",\"環泥\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"1109\",\"信大\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"1110\",\"東泥\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"1201\",\"味全\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"1203\",\"味王\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"1215\",\"卜蜂\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"1216\",\"統一\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"1217\",\"愛之味\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"1219\",\"福壽\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"1220\",\"台榮\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"1225\",\"福懋油\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"1229\",\"聯華\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"1231\",\"聯華食\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"1234\",\"黑松\",\"108.04.18\",\"108.04.23\",\"股東常會\"],[\"1235\",\"興泰\",\"108.04.18\",\"108.04.23\",\"股東常會\"],[\"1236\",\"宏亞\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"1262\",\"綠悅-KY\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"1305\",\"華夏\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"1308\",\"亞聚\",\"108.04.18\",\"108.04.23\",\"股東常會\"],[\"1309\",\"台達化\",\"108.04.18\",\"108.04.23\",\"股東常會\"],[\"1310\",\"台苯\",\"108.04.22\",\"108.04.25\",\"股東常會\"],[\"1316\",\"上曜\",\"108.04.18\",\"108.04.23\",\"股東常會\"],[\"1319\",\"東陽\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"1321\",\"大洋\",\"108.04.18\",\"108.04.23\",\"股東常會\"],[\"1323\",\"永裕\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"1325\",\"恆大\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"1402\",\"遠東新\",\"108.04.22\",\"108.04.25\",\"股東常會\"],[\"1416\",\"廣豐\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"1418\",\"東華\",\"108.04.15\",\"\",\"股東常會\"],[\"1432\",\"大魯閣\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"1434\",\"福懋\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"1435\",\"中福\",\"108.04.15\",\"\",\"股東常會\"],[\"1436\",\"華友聯\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"1437\",\"勤益控\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"1439\",\"中和\",\"108.04.18\",\"108.04.23\",\"股東常會\"],[\"1440\",\"南紡\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"1441\",\"大東\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"1442\",\"名軒\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"1445\",\"大宇\",\"108.04.11\",\"108.04.16\",\"股東常會\"],[\"1449\",\"佳和\",\"108.04.19\",\"\",\"股東常會\"],[\"1451\",\"年興\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"1454\",\"台富\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"1455\",\"集盛\",\"108.04.18\",\"108.04.23\",\"股東常會\"],[\"1456\",\"怡華\",\"108.04.22\",\"108.04.25\",\"股東常會\"],[\"1459\",\"聯發\",\"108.04.22\",\"\",\"股東常會\"],[\"1463\",\"強盛\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"1464\",\"得力\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"1465\",\"偉全\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"1466\",\"聚隆\",\"108.04.22\",\"108.04.25\",\"股東常會\"],[\"1468\",\"昶和\",\"108.04.22\",\"\",\"股東常會\"],[\"1470\",\"大統新創\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"1471\",\"首利\",\"108.04.19\",\"\",\"股東常會\"],[\"1472\",\"三洋紡\",\"108.04.12\",\"\",\"股東常會\"],[\"1473\",\"台南\",\"108.04.18\",\"108.04.23\",\"股東常會\"],[\"1474\",\"弘裕\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"1475\",\"本盟\",\"108.04.19\",\"\",\"股東常會\"],[\"1476\",\"儒鴻\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"1477\",\"聚陽\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"1503\",\"士電\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"1506\",\"正道\",\"108.04.18\",\"\",\"股東常會\"],[\"1507\",\"永大\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"1512\",\"瑞利\",\"108.04.19\",\"\",\"股東常會\"],[\"1513\",\"中興電\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"1514\",\"亞力\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"1517\",\"利奇\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"1521\",\"大億\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"1522\",\"堤維西\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"1525\",\"江申\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"1526\",\"日馳\",\"108.04.22\",\"108.04.25\",\"股東常會\"],[\"1527\",\"鑽全\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"1531\",\"高林股\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"1532\",\"勤美\",\"108.04.18\",\"108.04.23\",\"股東常會\"],[\"1535\",\"中宇\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"1538\",\"正峰新\",\"108.04.12\",\"\",\"股東常會\"],[\"1539\",\"巨庭\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"1540\",\"喬福\",\"108.04.22\",\"108.04.25\",\"股東常會\"],[\"1541\",\"錩泰\",\"108.04.22\",\"108.04.25\",\"股東常會\"],[\"1568\",\"倉佑\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"1582\",\"信錦\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"1589\",\"永冠-KY\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"1590\",\"亞德客-KY\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"1604\",\"聲寶\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"1611\",\"中電\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"1615\",\"大山\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"1617\",\"榮星\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"1618\",\"合機\",\"108.04.18\",\"108.04.23\",\"股東常會\"],[\"1713\",\"國化\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"1714\",\"和桐\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"1717\",\"長興\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"1720\",\"生達\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"1722\",\"台肥\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"1724\",\"台硝\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"1725\",\"元禎\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"1726\",\"永記\",\"108.04.22\",\"108.04.25\",\"股東常會\"],[\"1734\",\"杏輝\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"1735\",\"日勝化\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"1736\",\"喬山\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"1737\",\"臺鹽\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"1783\",\"和康生\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"1786\",\"科妍\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"1789\",\"神隆\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"1802\",\"台玻\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"1805\",\"寶徠\",\"108.04.22\",\"\",\"股東常會\"],[\"1809\",\"中釉\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"1810\",\"和成\",\"108.04.22\",\"108.04.25\",\"股東常會\"],[\"1817\",\"凱撒衛\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"1903\",\"士紙\",\"108.04.18\",\"108.04.23\",\"股東常會\"],[\"1905\",\"華紙\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"1907\",\"永豐餘\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"2002\",\"中鋼\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2006\",\"東和鋼鐵\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2007\",\"燁興\",\"108.04.12\",\"\",\"股東常會\"],[\"2008\",\"高興昌\",\"108.04.11\",\"108.04.16\",\"股東常會\"],[\"2009\",\"第一銅\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2010\",\"春源\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"2013\",\"中鋼構\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2014\",\"中鴻\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"2022\",\"聚亨\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"2023\",\"燁輝\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2025\",\"千興\",\"108.04.12\",\"\",\"股東常會\"],[\"2027\",\"大成鋼\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2028\",\"威致\",\"108.04.12\",\"\",\"股東常會\"],[\"2033\",\"佳大\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2038\",\"海光\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"2049\",\"上銀\",\"108.04.22\",\"108.04.25\",\"股東常會\"],[\"2059\",\"川湖\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"2069\",\"運錩\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"2102\",\"泰豐\",\"108.04.11\",\"108.04.16\",\"股東常會\"],[\"2104\",\"國際中橡\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2108\",\"南帝\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2109\",\"華豐\",\"108.04.15\",\"\",\"股東常會\"],[\"2114\",\"鑫永銓\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"2201\",\"裕隆\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"2204\",\"中華\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"2206\",\"三陽工業\",\"108.04.22\",\"108.04.25\",\"股東常會\"],[\"2207\",\"和泰車\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2208\",\"台船\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"2228\",\"劍麟\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2236\",\"百達-KY\",\"108.04.22\",\"108.04.25\",\"股東常會\"],[\"2239\",\"英利-KY\",\"108.04.18\",\"108.04.23\",\"股東常會\"],[\"2243\",\"宏旭-KY\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"2301\",\"光寶科\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"2302\",\"麗正\",\"108.04.15\",\"\",\"股東常會\"],[\"2312\",\"金寶\",\"108.04.18\",\"108.04.23\",\"股東常會\"],[\"2314\",\"台揚\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2316\",\"楠梓電\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2317\",\"鴻海\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"2324\",\"仁寶\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"2329\",\"華泰\",\"108.04.12\",\"\",\"股東常會\"],[\"2331\",\"精英\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2332\",\"友訊\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"2337\",\"旺宏\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2348\",\"海悅\",\"108.04.11\",\"108.04.16\",\"股東常會\"],[\"2349\",\"錸德\",\"108.04.12\",\"\",\"股東常會\"],[\"2351\",\"順德\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"2352\",\"佳世達\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"2354\",\"鴻準\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"2355\",\"敬鵬\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"2357\",\"華碩\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2358\",\"廷鑫\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"2360\",\"致茂\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2362\",\"藍天\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2363\",\"矽統\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"2365\",\"昆盈\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"2371\",\"大同\",\"108.04.11\",\"108.04.16\",\"股東常會\"],[\"2382\",\"廣達\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"2388\",\"威盛\",\"108.04.15\",\"\",\"股東常會\"],[\"2390\",\"云辰\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2399\",\"映泰\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2404\",\"漢唐\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2405\",\"浩鑫\",\"108.04.19\",\"\",\"股東常會\"],[\"2406\",\"國碩\",\"108.04.19\",\"\",\"股東常會\"],[\"2412\",\"中華電\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"2413\",\"環科\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2414\",\"精技\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"2417\",\"圓剛\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2421\",\"建準\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2426\",\"鼎元\",\"108.04.18\",\"108.04.23\",\"股東常會\"],[\"2427\",\"三商電\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2428\",\"興勤\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"2429\",\"銘旺科\",\"108.04.19\",\"\",\"股東常會\"],[\"2434\",\"統懋\",\"108.04.19\",\"\",\"股東常會\"],[\"2438\",\"翔耀\",\"108.04.19\",\"\",\"股東常會\"],[\"2439\",\"美律\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2440\",\"太空梭\",\"108.04.18\",\"\",\"股東常會\"],[\"2444\",\"兆勁\",\"108.04.22\",\"\",\"股東常會\"],[\"2448\",\"晶電\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2457\",\"飛宏\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2460\",\"建通\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"2462\",\"良得電\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"2466\",\"冠西電\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2468\",\"華經\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"2471\",\"資通\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"2472\",\"立隆電\",\"108.04.18\",\"108.04.23\",\"股東常會\"],[\"2475\",\"華映\",\"108.04.18\",\"\",\"股東常會\"],[\"2477\",\"美隆電\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"2488\",\"漢平\",\"108.04.18\",\"108.04.23\",\"股東常會\"],[\"2491\",\"吉祥全\",\"108.04.18\",\"\",\"股東常會\"],[\"2492\",\"華新科\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2497\",\"怡利電\",\"108.04.11\",\"108.04.16\",\"股東常會\"],[\"2498\",\"宏達電\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"2504\",\"國產\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2505\",\"國揚\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2509\",\"全坤建\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"2511\",\"太子\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"2514\",\"龍邦\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"2515\",\"中工\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"2516\",\"新建\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2524\",\"京城\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"2527\",\"宏璟\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"2528\",\"皇普\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2534\",\"宏盛\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"2535\",\"達欣工\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2537\",\"聯上發\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"2540\",\"愛山林\",\"108.04.22\",\"108.04.25\",\"股東常會\"],[\"2543\",\"皇昌\",\"108.04.12\",\"\",\"股東常會\"],[\"2545\",\"皇翔\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2546\",\"根基\",\"108.04.11\",\"108.04.16\",\"股東常會\"],[\"2547\",\"日勝生\",\"108.04.18\",\"108.04.23\",\"股東常會\"],[\"2601\",\"益航\",\"108.04.22\",\"108.04.25\",\"股東常會\"],[\"2603\",\"長榮\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"2605\",\"新興\",\"108.04.22\",\"108.04.25\",\"股東常會\"],[\"2607\",\"榮運\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"2608\",\"嘉里大榮\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"2609\",\"陽明\",\"108.04.19\",\"\",\"股東常會\"],[\"2610\",\"華航\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"2612\",\"中航\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2613\",\"中櫃\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"2615\",\"萬海\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2616\",\"山隆\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"2617\",\"台航\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"2618\",\"長榮航\",\"108.04.18\",\"108.04.23\",\"股東常會\"],[\"2636\",\"台驊投控\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"2702\",\"華園\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2706\",\"第一店\",\"108.04.18\",\"108.04.23\",\"股東常會\"],[\"2707\",\"晶華\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2809\",\"京城銀\",\"108.04.18\",\"108.04.23\",\"股東常會\"],[\"2812\",\"台中銀\",\"108.04.22\",\"108.04.25\",\"股東常會\"],[\"2816\",\"旺旺保\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2836\",\"高雄銀\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2841\",\"台開\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"2845\",\"遠東銀\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2849\",\"安泰銀\",\"108.04.22\",\"108.04.25\",\"股東常會\"],[\"2852\",\"第一保\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"2855\",\"統一證\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2886\",\"兆豐金\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"2892\",\"第一金\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"2901\",\"欣欣\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2903\",\"遠百\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"2904\",\"匯僑\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"2906\",\"高林\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2908\",\"特力\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2910\",\"統領\",\"108.04.22\",\"108.04.25\",\"股東常會\"],[\"2911\",\"麗嬰房\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"2915\",\"潤泰全\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"2936\",\"客思達-KY\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"3014\",\"聯陽\",\"108.04.18\",\"108.04.23\",\"股東常會\"],[\"3018\",\"同開\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"3024\",\"憶聲\",\"108.04.19\",\"\",\"股東常會\"],[\"3025\",\"星通\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"3032\",\"偉訓\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"3033\",\"威健\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"3036\",\"文曄\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"3037\",\"欣興\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"3043\",\"科風\",\"108.04.22\",\"\",\"股東常會\"],[\"3044\",\"健鼎\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"3050\",\"鈺德\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"3051\",\"力特\",\"108.04.12\",\"\",\"股東常會\"],[\"3052\",\"夆典\",\"108.04.18\",\"108.04.23\",\"股東常會\"],[\"3055\",\"蔚華科\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"3058\",\"立德\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"3060\",\"銘異\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"3062\",\"建漢\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"3090\",\"日電貿\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"3149\",\"正達\",\"108.04.18\",\"\",\"股東常會\"],[\"3164\",\"景岳\",\"108.04.22\",\"108.04.25\",\"股東常會\"],[\"3209\",\"全科\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"3229\",\"晟鈦\",\"108.04.19\",\"\",\"股東常會\"],[\"3257\",\"虹冠電\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"3266\",\"昇陽\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"3305\",\"昇貿\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"3308\",\"聯德\",\"108.04.19\",\"\",\"股東常會\"],[\"3312\",\"弘憶股\",\"108.04.11\",\"108.04.16\",\"股東常會\"],[\"3346\",\"麗清\",\"108.04.22\",\"108.04.25\",\"股東常會\"],[\"3376\",\"新日興\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"3383\",\"新世紀\",\"108.04.19\",\"\",\"股東常會\"],[\"3406\",\"玉晶光\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"3419\",\"譁裕\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"3437\",\"榮創\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"3481\",\"群創\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"3494\",\"誠研\",\"108.04.19\",\"\",\"股東常會\"],[\"3518\",\"柏騰\",\"108.04.18\",\"108.04.23\",\"股東常會\"],[\"3519\",\"綠能\",\"108.04.19\",\"\",\"股東常會\"],[\"3528\",\"安馳\",\"108.04.18\",\"108.04.23\",\"股東常會\"],[\"3530\",\"晶相光\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"3536\",\"誠創\",\"108.04.18\",\"\",\"股東常會\"],[\"3545\",\"敦泰\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"3550\",\"聯穎\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"3588\",\"通嘉\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"3591\",\"艾笛森\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"3593\",\"力銘\",\"108.04.19\",\"\",\"股東常會\"],[\"3596\",\"智易\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"3605\",\"宏致\",\"108.04.22\",\"108.04.25\",\"股東常會\"],[\"3622\",\"洋華\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"3645\",\"達邁\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"3661\",\"世芯-KY\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"3679\",\"新至陞\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"3682\",\"亞太電\",\"108.04.12\",\"\",\"股東常會\"],[\"3686\",\"達能\",\"108.04.19\",\"\",\"股東常會\"],[\"3694\",\"海華\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"3702\",\"大聯大\",\"108.04.22\",\"108.04.25\",\"股東常會\"],[\"3705\",\"永信\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"3711\",\"日月光投控\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"3712\",\"永崴投控\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"4104\",\"佳醫\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"4106\",\"雃博\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"4119\",\"旭富\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"4133\",\"亞諾法\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"4141\",\"龍燈-KY\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"4142\",\"國光生\",\"108.04.12\",\"\",\"股東常會\"],[\"4142\",\"國光生\",\"108.04.12\",\"\",\"現金增資\"],[\"4148\",\"全宇生技-KY\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"4190\",\"佐登-KY\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"4306\",\"炎洲\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"4438\",\"廣越\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"4540\",\"全球傳動\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"4555\",\"氣立\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"4562\",\"穎漢\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"4566\",\"時碩工業\",\"108.04.22\",\"108.04.25\",\"股東常會\"],[\"4720\",\"德淵\",\"108.04.18\",\"108.04.23\",\"股東常會\"],[\"4737\",\"華廣\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"4739\",\"康普\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"4746\",\"台耀\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"4763\",\"材料-KY\",\"108.04.22\",\"108.04.25\",\"股東常會\"],[\"4764\",\"雙鍵\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"4807\",\"日成-KY\",\"108.04.22\",\"108.04.25\",\"股東常會\"],[\"4904\",\"遠傳\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"4906\",\"正文\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"4912\",\"聯德控股-KY\",\"108.04.11\",\"108.04.16\",\"股東常會\"],[\"4915\",\"致伸\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"4919\",\"新唐\",\"108.04.18\",\"108.04.23\",\"股東常會\"],[\"4930\",\"燦星網\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"4934\",\"太極\",\"108.04.15\",\"\",\"股東常會\"],[\"4935\",\"茂林-KY\",\"108.04.18\",\"108.04.23\",\"股東常會\"],[\"4938\",\"和碩\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"4942\",\"嘉彰\",\"108.04.18\",\"108.04.23\",\"股東常會\"],[\"4943\",\"康控-KY\",\"108.04.11\",\"108.04.16\",\"股東常會\"],[\"4958\",\"臻鼎-KY\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"4960\",\"誠美材\",\"108.04.22\",\"\",\"股東常會\"],[\"4976\",\"佳凌\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"4989\",\"榮科\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"4994\",\"傳奇\",\"108.04.12\",\"\",\"股東常會\"],[\"4999\",\"鑫禾\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"5203\",\"訊連\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"5215\",\"科嘉-KY\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"5243\",\"乙盛-KY\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"5258\",\"虹堡\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"5284\",\"jpp-KY\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"5285\",\"界霖\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"5305\",\"敦南\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"5515\",\"建國\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"5519\",\"隆大\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"5521\",\"工信\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"5531\",\"鄉林\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"5534\",\"長虹\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"5607\",\"遠雄港\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"5608\",\"四維航\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"5880\",\"合庫金\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"5906\",\"台南-KY\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"5907\",\"大洋-KY\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"6005\",\"群益證\",\"108.04.18\",\"108.04.23\",\"股東常會\"],[\"6108\",\"競國\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"6115\",\"鎰勝\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"6117\",\"迎廣\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"6128\",\"上福\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"6133\",\"金橋\",\"108.04.22\",\"108.04.25\",\"股東常會\"],[\"6136\",\"富爾特\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"6141\",\"柏承\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"6142\",\"友勁\",\"108.04.15\",\"\",\"股東常會\"],[\"6152\",\"百一\",\"108.04.12\",\"\",\"股東常會\"],[\"6165\",\"捷泰\",\"108.04.22\",\"\",\"股東常會\"],[\"6166\",\"凌華\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"6168\",\"宏齊\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"6183\",\"關貿\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"6191\",\"精成科\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"6192\",\"巨路\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"6205\",\"詮欣\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"6209\",\"今國光\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"6216\",\"居易\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"6224\",\"聚鼎\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"6225\",\"天瀚\",\"108.04.12\",\"\",\"股東常會\"],[\"6230\",\"超眾\",\"108.04.18\",\"108.04.23\",\"股東常會\"],[\"6235\",\"華孚\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"6269\",\"台郡\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"6271\",\"同欣電\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"6282\",\"康舒\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"6289\",\"華上\",\"108.04.15\",\"\",\"股東常會\"],[\"6409\",\"旭隼\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"6414\",\"樺漢\",\"108.04.22\",\"108.04.25\",\"股東常會\"],[\"6431\",\"光麗-KY\",\"108.04.22\",\"\",\"股東常會\"],[\"6449\",\"鈺邦\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"6451\",\"訊芯-KY\",\"108.04.18\",\"108.04.23\",\"股東常會\"],[\"6452\",\"康友-KY\",\"108.04.22\",\"108.04.25\",\"股東常會\"],[\"6533\",\"晶心科\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"6541\",\"泰福-KY\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"6582\",\"申豐\",\"108.04.22\",\"108.04.25\",\"股東常會\"],[\"6605\",\"帝寶\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"6625\",\"必應\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"8016\",\"矽創\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"8033\",\"雷虎\",\"108.04.19\",\"\",\"股東常會\"],[\"8070\",\"長華\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"8072\",\"陞泰\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"8101\",\"華冠\",\"108.04.12\",\"\",\"股東常會\"],[\"8103\",\"瀚荃\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"8105\",\"凌巨\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"8110\",\"華東\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"8112\",\"至上\",\"108.04.22\",\"108.04.25\",\"股東常會\"],[\"8131\",\"福懋科\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"8201\",\"無敵\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"8210\",\"勤誠\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"8215\",\"明基材\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"8222\",\"寶一\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"8249\",\"菱光\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"8367\",\"建新國際\",\"108.04.18\",\"108.04.23\",\"股東常會\"],[\"8374\",\"羅昇\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"8411\",\"福貞-KY\",\"108.04.18\",\"108.04.23\",\"股東常會\"],[\"8429\",\"金麗-KY\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"8442\",\"威宏-KY\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"8443\",\"阿瘦\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"8464\",\"億豐\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"8480\",\"泰昇-KY\",\"108.04.22\",\"108.04.25\",\"股東常會\"],[\"8481\",\"政伸\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"8488\",\"吉源-KY\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"8497\",\"聯廣\",\"108.04.18\",\"108.04.23\",\"股東常會\"],[\"8926\",\"台汽電\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"8996\",\"高力\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"9136\",\"巨騰-DR\",\"108.04.18\",\"108.04.23\",\"股東常會\"],[\"9902\",\"台火\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"9905\",\"大華\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"9906\",\"欣巴巴\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"9907\",\"統一實\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"9911\",\"櫻花\",\"108.04.18\",\"108.04.23\",\"股東常會\"],[\"9912\",\"偉聯\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"9914\",\"美利達\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"9918\",\"欣天然\",\"108.04.22\",\"108.04.25\",\"股東常會\"],[\"9921\",\"巨大\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"9924\",\"福興\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"9926\",\"新海\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"9927\",\"泰銘\",\"108.04.22\",\"108.04.25\",\"股東常會\"],[\"9928\",\"中視\",\"108.04.19\",\"\",\"股東常會\"],[\"9930\",\"中聯資源\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"9935\",\"慶豐富\",\"108.04.22\",\"108.04.25\",\"股東常會\"],[\"9937\",\"全國\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"9939\",\"宏全\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"9941\",\"裕融\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"9943\",\"好樂迪\",\"108.04.19\",\"108.04.24\",\"股東常會\"],[\"9944\",\"新麗\",\"108.04.15\",\"108.04.18\",\"股東常會\"],[\"9946\",\"三發地產\",\"108.04.18\",\"108.04.23\",\"股東常會\"],[\"9955\",\"佳龍\",\"108.04.12\",\"108.04.17\",\"股東常會\"],[\"9958\",\"世紀鋼\",\"108.04.18\",\"108.04.23\",\"股東常會\"]]}";

    private static void renewLoanDate() throws Exception {
        int count = 0;
        Connection conn = null;

        try {
            conn = DbTool.getConn();

            ArrayList<StockLoanView> views = parseData();
            for (StockLoanView view : views) {
                insert(conn, view);
            }
        } catch (Exception e) {
            System.out.println("壞掉了");
            e.printStackTrace();
        } finally {
            DbTool.closeConnection(conn);
        }
    }

    public static ArrayList<StockLoanView> parseData() throws IOException {
        ArrayList<StockLoanView> views = new ArrayList<StockLoanView>();

        JsonReader reader = new JsonReader(new StringReader(result));
        reader.setLenient(true);
        reader.beginObject();

        while (reader.hasNext()) {
            String name = reader.nextName();
            if (!"data".equals(name)) {
                reader.skipValue();
                continue;
            }

            reader.beginArray();
            while (reader.hasNext()) {
                reader.beginArray();
                StockLoanView view = new StockLoanView();

                int index = 0;
                while (reader.hasNext()) {
                    switch (index) {
                        case INDEX_ID:
                            view.setId(reader.nextString());
                            break;
                        case INDEX_NAME:
                            view.setName(reader.nextString());
                            break;
                        case INDEX_DATEFROM:
                            view.setDateFrom(reader.nextString());
                            break;
                        case INDEX_DATEEND:
                            view.setDateEnd(reader.nextString());
                            break;
                        case INDEX_REASON:
                            view.setReason(reader.nextString());
                            break;
                    }
                    index++;
                }
                views.add(view);
                reader.endArray();
            }
            reader.endArray();
        }

        return views;
    }

    private static void insert(Connection conn, StockLoanView view) throws SQLException {
        String sql = "INSERT INTO stockloan (id,name, dateFrom, dateEnd, reason) VALUES (?,?,?,?,?)";

        PreparedStatement pstmt = null;
        try {
            pstmt = conn.prepareStatement(sql);
            pstmt.setString(1, view.getId());
            pstmt.setString(2, view.getName());
            pstmt.setString(3, view.getDateFrom());
            pstmt.setString(4, view.getDateEnd());
            pstmt.setString(5, view.getReason());
            pstmt.executeUpdate();
            pstmt.close();

        } catch (SQLException e) {
            if (1062 == e.getErrorCode()) {
                System.out.println(view.getId() + "is already exists.");
                return;
            }

            throw e;
        }
    }

    public static void main(String[] args) throws Exception {
        renewLoanDate();
    }
}
